<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Pesticide Supply System</title>
    <link rel="stylesheet" href="/css/cart.css">
</head>
<body>
    <div class="main-bg">
        <header>
            <h1>Checkout</h1>
        </header>
        <section id="checkout">
            <h2>Your Order</h2>
            <div id="order-summary">
                <ul>
                    <% 
                        let total = 0;
                        cart.forEach(function(cartItem) {
                            const product = DBproducts.find(p => p.id === cartItem.id);
                            if (product) {
                                const itemTotal = product.price * cartItem.quantity;
                                total += itemTotal;
                    %>
                    <li>
                        <strong><%= product.product %></strong> (x<%= cartItem.quantity %>) - $<%= itemTotal.toFixed(2) %>
                    </li>
                    <% }}); %>
                </ul>
                <div id="total-price"><strong>Total:</strong> $<%= total.toFixed(2) %></div>
            </div>
            <form id="checkout-form" action="/checkout/submit" method="POST" onsubmit="return validateConfirm();">
                <h3>Order Confirmation</h3>
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>

                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>

                <label for="address">Delivery Address:</label>
                <textarea id="address" name="address" required></textarea>

                <div>
                    <input type="checkbox" id="confirm" name="confirm" required>
                    <label for="confirm">I confirm these are the items I ordered.</label>
                </div>

                <button type="submit">Confirm Order</button>
            </form>
        </section>
        <footer>
            <p>&copy; 2023 Pesticide Supply System</p>
        </footer>
    </div>
    <script src="/js/cart.js"></script>
    <script>
    function validateConfirm() {
        if (!document.getElementById('confirm').checked) {
            alert('Please confirm your order.');
            return false;
        }
        return true;
    }
    </script>
</body>
</html>